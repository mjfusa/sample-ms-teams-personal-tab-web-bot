{"version":3,"file":"server.js","mappings":"sbACa,EAAAA,MAAQ,CAAC,EAEtB,W,8bCHA,eAMA,IAAaC,EAAb,QAAaA,EAAY,GADxB,EAAAC,cAAc,gBACFD,GAAA,EAAAA,aAAAA,C,UCNbE,EAAOC,QAAUC,QAAQ,c,UCAzBF,EAAOC,QAAUC,QAAQ,Q,UCAzBF,EAAOC,QAAUC,QAAQ,S,UCAzBF,EAAOC,QAAUC,QAAQ,U,UCAzBF,EAAOC,QAAUC,QAAQ,uB,UCAzBF,EAAOC,QAAUC,QAAQ,S,UCAzBF,EAAOC,QAAUC,QAAQ,O,SCAzBF,EAAOC,QAAUC,QAAQ,O,GCCrBC,EAA2B,CAAC,EAGhC,SAASC,EAAoBC,GAE5B,IAAIC,EAAeH,EAAyBE,GAC5C,QAAqBE,IAAjBD,EACH,OAAOA,EAAaL,QAGrB,IAAID,EAASG,EAAyBE,GAAY,CAGjDJ,QAAS,CAAC,GAOX,OAHAO,EAAoBH,GAAUI,KAAKT,EAAOC,QAASD,EAAQA,EAAOC,QAASG,GAGpEJ,EAAOC,OACf,C,MCtBA,eACA,SACA,QACA,SACA,SACA,SACA,SAGMS,EAAMC,EAAM,WAElBD,EAAI,sDAGJ,gBAIA,cAGME,EAAUC,IACVC,EAAOC,QAAQC,IAAIF,MAAQC,QAAQC,IAAIC,MAAQ,KAGrDL,EAAQM,IAAIL,EAAQM,KAAK,CACrBC,OAAQ,CAACC,EAAKC,EAAKC,EAAaC,KAC3BH,EAAYI,QAAUF,EAAIG,UAAU,KAG7Cd,EAAQM,IAAIL,EAAQc,WAAW,CAAEC,UAAU,KAG3ChB,EAAQiB,IAAI,QAASC,EAAKC,KAAKC,UAAW,MAG1CpB,EAAQM,IAAIe,EAAO,SAGnBrB,EAAQM,IAAIgB,KAGZtB,EAAQM,IAAI,WAAYL,EAAQsB,OAAOL,EAAKC,KAAKC,UAAW,iBAC5DpB,EAAQM,IAAI,UAAWL,EAAQsB,OAAOL,EAAKC,KAAKC,UAAW,gBAI3DpB,EAAQM,IAAI,EAAAkB,iBAAiBC,IAI7BzB,EAAQM,IAAI,EAAAoB,kBAAkB,CAC1BC,KAAMT,EAAKC,KAAKC,UAAW,QAC3BQ,WAAYH,KAIhBzB,EAAQM,IAAI,IAAKL,EAAQsB,OAAOL,EAAKC,KAAKC,UAAW,QAAS,CAC1DS,MAAO,gBAIX7B,EAAQiB,IAAI,OAAQf,GAGpB4B,EAAKC,aAAa/B,GAASgC,OAAO9B,GAAM,KACpCJ,EAAI,qBAAqBI,IAAO,G","sources":["webpack://myprofiletab/./src/server/TeamsAppsComponents.ts?6a42","webpack://myprofiletab/./src/server/myProfileTab/MyProfileTab.ts?84ee","webpack://myprofiletab/external commonjs \"compression\"?e0c2","webpack://myprofiletab/external commonjs \"debug\"?b525","webpack://myprofiletab/external commonjs \"dotenv\"?3fba","webpack://myprofiletab/external commonjs \"express\"?c4a6","webpack://myprofiletab/external commonjs \"express-msteams-host\"?eac2","webpack://myprofiletab/external commonjs \"morgan\"?66c0","webpack://myprofiletab/external node-commonjs \"http\"?78d4","webpack://myprofiletab/external node-commonjs \"path\"?1f34","[]","webpack://myprofiletab/./src/server/server.ts?3175"],"sourcesContent":["// Components will be added here\r\nexport const nonce = {}; // Do not remove!\r\n// Automatically added for the myProfileTab tab\r\nexport * from \"./myProfileTab/MyProfileTab\";\r\n","import { PreventIframe } from \"express-msteams-host\";\r\n\r\n/**\r\n * Used as place holder for the decorators\r\n */\r\n@PreventIframe(\"/index.html\")\r\nexport class MyProfileTab {\r\n}\r\n","module.exports = require(\"compression\");","module.exports = require(\"debug\");","module.exports = require(\"dotenv\");","module.exports = require(\"express\");","module.exports = require(\"express-msteams-host\");","module.exports = require(\"morgan\");","module.exports = require(\"http\");","module.exports = require(\"path\");","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","import * as Express from \"express\";\r\nimport * as http from \"http\";\r\nimport * as path from \"path\";\r\nimport * as morgan from \"morgan\";\r\nimport { MsTeamsApiRouter, MsTeamsPageRouter } from \"express-msteams-host\";\r\nimport * as debug from \"debug\";\r\nimport * as compression from \"compression\";\r\n\r\n// Initialize debug logging module\r\nconst log = debug(\"msteams\");\r\n\r\nlog(\"Initializing Microsoft Teams Express hosted App...\");\r\n\r\n// Initialize dotenv, to use .env file settings if existing\r\nrequire(\"dotenv\").config();\r\n\r\n// The import of components has to be done AFTER the dotenv config\r\n// eslint-disable-next-line import/first\r\nimport * as allComponents from \"./TeamsAppsComponents\";\r\n\r\n// Create the Express webserver\r\nconst express = Express();\r\nconst port = process.env.port || process.env.PORT || 3007;\r\n\r\n// Inject the raw request body onto the request object\r\nexpress.use(Express.json({\r\n    verify: (req, res, buf: Buffer, encoding: string): void => {\r\n        (req as any).rawBody = buf.toString();\r\n    }\r\n}));\r\nexpress.use(Express.urlencoded({ extended: true }));\r\n\r\n// Express configuration\r\nexpress.set(\"views\", path.join(__dirname, \"/\"));\r\n\r\n// Add simple logging\r\nexpress.use(morgan(\"tiny\"));\r\n\r\n// Add compression - uncomment to remove compression\r\nexpress.use(compression());\r\n\r\n// Add /scripts and /assets as static folders\r\nexpress.use(\"/scripts\", Express.static(path.join(__dirname, \"web/scripts\")));\r\nexpress.use(\"/assets\", Express.static(path.join(__dirname, \"web/assets\")));\r\n\r\n// routing for bots, connectors and incoming web hooks - based on the decorators\r\n// For more information see: https://www.npmjs.com/package/express-msteams-host\r\nexpress.use(MsTeamsApiRouter(allComponents));\r\n\r\n// routing for pages for tabs and connector configuration\r\n// For more information see: https://www.npmjs.com/package/express-msteams-host\r\nexpress.use(MsTeamsPageRouter({\r\n    root: path.join(__dirname, \"web/\"),\r\n    components: allComponents\r\n}));\r\n\r\n// Set default web page\r\nexpress.use(\"/\", Express.static(path.join(__dirname, \"web/\"), {\r\n    index: \"index.html\"\r\n}));\r\n\r\n// Set the port\r\nexpress.set(\"port\", port);\r\n\r\n// Start the webserver\r\nhttp.createServer(express).listen(port, () => {\r\n    log(`Server running on ${port}`);\r\n});\r\n"],"names":["nonce","MyProfileTab","PreventIframe","module","exports","require","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","call","log","debug","express","Express","port","process","env","PORT","use","json","verify","req","res","buf","encoding","rawBody","toString","urlencoded","extended","set","path","join","__dirname","morgan","compression","static","MsTeamsApiRouter","allComponents","MsTeamsPageRouter","root","components","index","http","createServer","listen"],"sourceRoot":""}